<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Flask 是一个轻量级的 WSGI Web 应用程序框架。它旨在使快速入门 Web 开发变得容易，并具有扩展到复杂应用程序的能力。它最初是围绕 Werkzeug 和 Jinja 的简单包装，现在已成为最受欢迎的 Python Web 应用程序框架之一。">
<meta property="og:type" content="article">
<meta property="og:title" content="认识 Flask">
<meta property="og:url" content="https://lijianxun.top/3.html">
<meta property="og:site_name" content="简讯的个人博客">
<meta property="og:description" content="Flask 是一个轻量级的 WSGI Web 应用程序框架。它旨在使快速入门 Web 开发变得容易，并具有扩展到复杂应用程序的能力。它最初是围绕 Werkzeug 和 Jinja 的简单包装，现在已成为最受欢迎的 Python Web 应用程序框架之一。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-05-03T05:44:43.000Z">
<meta property="article:modified_time" content="2022-11-01T05:46:11.966Z">
<meta property="article:author" content="简讯">
<meta property="article:tag" content="Flask">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>认识 Flask</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/me.html">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/alpha87">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/330.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/1.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lijianxun.top/3.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lijianxun.top/3.html&text=认识 Flask"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lijianxun.top/3.html&is_video=false&description=认识 Flask"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=认识 Flask&body=Check out this article: https://lijianxun.top/3.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lijianxun.top/3.html&name=认识 Flask&description=&lt;p&gt;&lt;a href=&#34;https://github.com/pallets/flask&#34;&gt;Flask&lt;/a&gt; 是一个轻量级的 WSGI Web 应用程序框架。它旨在使快速入门 Web 开发变得容易，并具有扩展到复杂应用程序的能力。它最初是围绕 Werkzeug 和 Jinja 的简单包装，现在已成为最受欢迎的 Python Web 应用程序框架之一。&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lijianxun.top/3.html&t=认识 Flask"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-WSGI"><span class="toc-number">1.</span> <span class="toc-text">什么是 WSGI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA-Flask-%E5%BA%94%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">第一个 Flask 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-number">3.1.</span> <span class="toc-text">运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">调试模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BF%E9%97%AE"><span class="toc-number">3.3.</span> <span class="toc-text">局域网访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Flask-%E5%86%85%E7%BD%AE-click-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="toc-number">3.4.</span> <span class="toc-text">使用 Flask 内置 click 自定义命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flask-script"><span class="toc-number">3.5.</span> <span class="toc-text">flask-script</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-flask-script-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="toc-number">3.5.1.</span> <span class="toc-text">使用 flask-script 自定义命令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E7%9A%84-Web-%E5%BA%94%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">包含动态路由的 Web 应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-url-for-%E5%8F%8D%E5%90%91%E6%9E%84%E5%BB%BA-URL"><span class="toc-number">5.</span> <span class="toc-text">使用 url_for() 反向构建 URL</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        认识 Flask
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">简讯</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-05-03T05:44:43.000Z" itemprop="datePublished">2022-05-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Flask/" rel="tag">Flask</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><a target="_blank" rel="noopener" href="https://github.com/pallets/flask">Flask</a> 是一个轻量级的 WSGI Web 应用程序框架。它旨在使快速入门 Web 开发变得容易，并具有扩展到复杂应用程序的能力。它最初是围绕 Werkzeug 和 Jinja 的简单包装，现在已成为最受欢迎的 Python Web 应用程序框架之一。</p>
<span id="more"></span>

<h1 id="什么是-WSGI"><a href="#什么是-WSGI" class="headerlink" title="什么是 WSGI"></a>什么是 WSGI</h1><p>WSGI 的全名是 Web Server Gateway Interface，Web 服务器网络接口，是为 Python 语言定义的 Web 服务器和 Web 应用程序或框架之间的一种简单而通用的接口。重点在<strong>通用</strong>。简单理解就是 Python 的 Web 框架有很多，需要搭建一个通用网关，这样不论什么框架写的 Web 程序都能统一运行。毕竟统一和规范才能进步。</p>
<p>其实这个简单了解一下就行，因为在实际开发中不会感受到它的存在，想深入的同学可以多了解。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>Flask 主要由两大部分组成：<a target="_blank" rel="noopener" href="https://github.com/pallets/werkzeug">Werkzeug</a> 和 <a target="_blank" rel="noopener" href="https://github.com/pallets/jinja">Jinja</a>。前者用来管理 Flask 的路由，调试，WSGI，后者就是 Flask 的模板系统。</p>
<p>可以使用 pipenv 创建新的虚拟环境，因为我的电脑里 Python3 的版本默认为 Python 3.8，所以在创建 Python3 环境的时候也会默认选择 Python 3.8 来搭建虚拟环境。不过只要是 Python 3.6 以上版本就基本差不多。</p>
<p>如果没有使用虚拟环境也不影响，安装命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -m pip install -U flask<br></code></pre></td></tr></table></figure>

<p>这条命令保证使用 Python3 的 pip 包来安装 Flask，并且如果你之前已经安装了 Flask，那么这次安装就会更新。</p>
<p>如果是虚拟环境，安装命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pipenv install flask<br></code></pre></td></tr></table></figure>

<h1 id="第一个-Flask-应用"><a href="#第一个-Flask-应用" class="headerlink" title="第一个 Flask 应用"></a>第一个 Flask 应用</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_world</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello, World!&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>使用终端，在当前目录执行 <code>flask run</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">(FlaskGuide) ➜  FlaskGuide flask run<br> * Environment: production<br>   WARNING: This is a development server. Do not use it <span class="hljs-keyword">in</span> a production deployment.<br>   Use a production WSGI server instead.<br> * Debug mode: off<br> * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)<br><br>127.0.0.1 - - [13/Feb/2020 02:21:09] <span class="hljs-string">&quot;GET / HTTP/1.1&quot;</span> 200 -<br></code></pre></td></tr></table></figure>

<p>在本地打开 <code>http://127.0.0.1:5000/</code>，使用五行代码完成了第一个 Web 应用。几乎所有的 Flask 应用中，<code>app</code> 总是等于 <code>Flask(__name__)</code>。这是因为 Flask 类的构造函数有一个必须指定的参数，就是程序主模块或者包的名字，一般程序中，程序的主模块或者包的名字就是本身程序的名称，也就是 <code>__name__</code>。</p>
<p>可能在之前的一些教程中，大部分都会有如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure>

<p>其实现在的版本也可以这样执行，但是不被建议。而且最好添加环境变量，如果 Flask 应用默认是 <code>app.py</code>，可以直接执行 <code>flask run</code>，如果是其他名称，就一定需要明确。例如新建了一个名为 <code>hello.py</code> 的应用，那么就要在环境变量中指明：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> FLASK_APP=hello.py<br></code></pre></td></tr></table></figure>

<p>指明之后就可以使用 <code>flask run</code> 命令开启服务了。</p>
<p>不过每次打开新的终端都要设置 FLASK_APP，很不方便，推荐使用 Flask 的 dotenv 自动设置环境变量。这里需要安装 <a target="_blank" rel="noopener" href="https://github.com/theskumar/python-dotenv">python-dotenv</a>，它会从 <code>.env</code> 文件中读取键值对，并将其添加到环境变量。</p>
<p>启动 Flask 应用时，会根据终端设置环境变量，<code>.env</code>，<code>.flaskenv</code> 的优先级加载环境变量。我们可以在当前目录下创建 <code>.flaskenv</code> 文件来存放环境变量。这样保证每次重新打开终端都不必再次设定环境变量键值。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FLASK_APP=hello.py<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://flask.palletsprojects.com/en/1.1.x/cli/?highlight=dotenv#environment-variables-from-dotenv">了解环境变量设置详情点击此处。</a></p>
<h2 id="调试模式"><a href="#调试模式" class="headerlink" title="调试模式"></a>调试模式</h2><p>之前调试起来相比之下比较方便：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p>现在同样需要在环境变量里明确。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> FLASK_ENV=development<br></code></pre></td></tr></table></figure>

<p>这样在启动就是调试模式，在改动代码之后会自动重启服务。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">(FlaskGuide) ➜  FlaskGuide flask run<br> * Environment: development<br> * Debug mode: on<br> * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)<br> * Restarting with <span class="hljs-built_in">stat</span><br> * Debugger is active!<br> * Debugger PIN: 169-605-104<br></code></pre></td></tr></table></figure>

<h2 id="局域网访问"><a href="#局域网访问" class="headerlink" title="局域网访问"></a>局域网访问</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flask run --host=0.0.0.0<br></code></pre></td></tr></table></figure>

<p>这样运行会监听所有公共 IP，只要在其他设备输入本地局域网 IP 就可以访问了。</p>
<h2 id="使用-Flask-内置-click-自定义命令"><a href="#使用-Flask-内置-click-自定义命令" class="headerlink" title="使用 Flask 内置 click 自定义命令"></a>使用 Flask 内置 click 自定义命令</h2><p>我们可以使用 <code>flask --help</code> 命令查看现有的命令，同样我们可以自定义命令。通过自定义命令会帮助我们解决许多重复工作，Flask 提供了非常便捷的接口。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template<br><span class="hljs-keyword">import</span> click<br><br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.cli.command()</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;Echo &#x27;Hello, World!&#x27;&quot;&quot;&quot;</span><br>    click.echo(<span class="hljs-string">&quot;Hello, World!&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>在终端输入命令：<code>flask --help</code>，会发现我们自定义命令已经被注册：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">...<br><br>Commands:<br>  hello   Echo <span class="hljs-string">&#x27;Hello, World!&#x27;</span><br>  routes  Show the routes <span class="hljs-keyword">for</span> the app.<br>  run     Run a development server.<br>  shell   Run a shell <span class="hljs-keyword">in</span> the app context.<br></code></pre></td></tr></table></figure>

<p>在终端里运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">(FlaskGuide) ➜  FlaskGuide flask hello<br>Hello, World!<br></code></pre></td></tr></table></figure>

<h2 id="flask-script"><a href="#flask-script" class="headerlink" title="flask-script"></a>flask-script</h2><p>当然了，如果你还是习惯使用 <code>app.run()</code>，可以尝试使用 <code>flask-script</code> 库。</p>
<p><code>flask-script</code> 是 Flask 的拓展，为 Flask Web 程序添加了命令行解释器，还能自定义命令。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask_script <span class="hljs-keyword">import</span> Manager<br><br><br>app = Flask(__name__)<br>manager = Manager(app)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello, world.&quot;</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    manager.run()<br></code></pre></td></tr></table></figure>

<p>在终端直接运行 <code>python3 app.py</code>，会提示你少参数，也会提示一些常用参数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">(FlaskGuide) ➜  FlaskGuide python app.py          <br>usage: app.py [-?] &#123;shell,runserver&#125; ...<br><br>positional arguments:<br>  &#123;shell,runserver&#125;<br>    shell            Runs a Python shell inside Flask application context.<br>    runserver        Runs the Flask development server i.e. app.run()<br><br>optional arguments:<br>  -?, --<span class="hljs-built_in">help</span>         show this <span class="hljs-built_in">help</span> message and <span class="hljs-built_in">exit</span><br><br></code></pre></td></tr></table></figure>

<p>如果想运行程序，执行 <code>python app.py runserver</code> 命令。</p>
<h3 id="使用-flask-script-自定义命令"><a href="#使用-flask-script-自定义命令" class="headerlink" title="使用 flask-script 自定义命令"></a>使用 flask-script 自定义命令</h3><p>举个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask_script <span class="hljs-keyword">import</span> Manager, Command<br><br><br>app = Flask(__name__)<br>manager = Manager(app)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hello</span>(<span class="hljs-title class_ inherited__">Command</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;自定义命令测试&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    manager.add_command(<span class="hljs-string">&#x27;hello&#x27;</span>, Hello())<br>    manager.run()<br></code></pre></td></tr></table></figure>

<p>终端运行 <code>python3 app.py hello</code> 就会执行自定义命令的 <code>run()</code> 方法了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">(FlaskGuide) ➜  FlaskGuide python app.py hello<br>自定义命令测试<br></code></pre></td></tr></table></figure>

<p>其他使用方法还需查看<a target="_blank" rel="noopener" href="https://flask-script.readthedocs.io/en/latest/">官方文档</a>，非常详细。</p>
<h1 id="包含动态路由的-Web-应用"><a href="#包含动态路由的-Web-应用" class="headerlink" title="包含动态路由的 Web 应用"></a>包含动态路由的 Web 应用</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_stranger</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello, Stranger!&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_user</span>(<span class="hljs-params">username</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;Hello, <span class="hljs-subst">&#123;username&#125;</span>!&#x27;</span><br></code></pre></td></tr></table></figure>

<p><code>username</code> 就是通过 URL 动态获取的。</p>
<p>上边这部分代码还支持两种写法：</p>
<p>第一种，通过函数默认值的写法提供默认参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span></span>)</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_user</span>(<span class="hljs-params">username=<span class="hljs-string">&quot;Stranger&quot;</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;Hello, <span class="hljs-subst">&#123;username&#125;</span>!&#x27;</span><br></code></pre></td></tr></table></figure>

<p>第二种，通过路由默认配置字段传递默认参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user&#x27;</span>, defaults=&#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Stranger&quot;</span>&#125;</span>)</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello_user</span>(<span class="hljs-params">username</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;Hello, <span class="hljs-subst">&#123;username&#125;</span>!&#x27;</span><br></code></pre></td></tr></table></figure>

<p>动态路由支持 int、float、string、 path 和 uuid 五种类型。前两种为数字，后三种为字符串，path 是可以包含斜杠的字符串。</p>
<table>
<thead>
<tr>
<th>转换器类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>string</td>
<td>（默认）接受不带斜杠的任何文本</td>
</tr>
<tr>
<td>int</td>
<td>接受正整数</td>
</tr>
<tr>
<td>float</td>
<td>接受正浮点值</td>
</tr>
<tr>
<td>path</td>
<td>喜欢 string 但也接受斜线</td>
</tr>
<tr>
<td>uuid</td>
<td>接受 UUID 字符串</td>
</tr>
</tbody></table>
<p>因为动态路由支持不同类型，所以我们可以传入不同的值来执行不同路由的任务。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&lt;int:parameter&gt;&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parameter_int</span>(<span class="hljs-params">parameter</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;传入参数类型 Int&quot;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&lt;float:parameter&gt;&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parameter_float</span>(<span class="hljs-params">parameter</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;传入参数类型 Float&quot;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&lt;parameter&gt;&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parameter_string</span>(<span class="hljs-params">parameter</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;传入参数类型 String&quot;</span><br></code></pre></td></tr></table></figure>

<h1 id="使用-url-for-反向构建-URL"><a href="#使用-url-for-反向构建-URL" class="headerlink" title="使用 url_for() 反向构建 URL"></a>使用 <code>url_for()</code> 反向构建 URL</h1><p>把 url 硬编码到模板中这种事情还是不要做得好，Flask 已经提供了映射方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, url_for<br><span class="hljs-keyword">from</span> markupsafe <span class="hljs-keyword">import</span> escape<br><br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;index&#x27;</span><br><br><span class="hljs-keyword">with</span> app.test_request_context():<br>    <span class="hljs-built_in">print</span>(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))<br></code></pre></td></tr></table></figure>

<p>可能第一次看到这种写法有点蒙圈，其实就是使用函数名获取路径名。</p>
<p>通过 <code>index</code> 找到对应节点 <code>/</code>。</p>
<p>也可以用这种方法导入静态文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">url_for(<span class="hljs-string">&#x27;static&#x27;</span>, filename=<span class="hljs-string">&#x27;style.css&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>对应静态文件路径：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">static/style.css<br></code></pre></td></tr></table></figure>

<p>使用 <code>url_for()</code> 默认生成相对 URL，如果想要生成绝对 URL 地址，需要添加参数 <code>_external=True</code>。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/me.html">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/alpha87">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-WSGI"><span class="toc-number">1.</span> <span class="toc-text">什么是 WSGI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA-Flask-%E5%BA%94%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">第一个 Flask 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-number">3.1.</span> <span class="toc-text">运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">调试模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BF%E9%97%AE"><span class="toc-number">3.3.</span> <span class="toc-text">局域网访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Flask-%E5%86%85%E7%BD%AE-click-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="toc-number">3.4.</span> <span class="toc-text">使用 Flask 内置 click 自定义命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flask-script"><span class="toc-number">3.5.</span> <span class="toc-text">flask-script</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-flask-script-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="toc-number">3.5.1.</span> <span class="toc-text">使用 flask-script 自定义命令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E7%9A%84-Web-%E5%BA%94%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">包含动态路由的 Web 应用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-url-for-%E5%8F%8D%E5%90%91%E6%9E%84%E5%BB%BA-URL"><span class="toc-number">5.</span> <span class="toc-text">使用 url_for() 反向构建 URL</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lijianxun.top/3.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lijianxun.top/3.html&text=认识 Flask"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lijianxun.top/3.html&is_video=false&description=认识 Flask"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=认识 Flask&body=Check out this article: https://lijianxun.top/3.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lijianxun.top/3.html&title=认识 Flask"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lijianxun.top/3.html&name=认识 Flask&description=&lt;p&gt;&lt;a href=&#34;https://github.com/pallets/flask&#34;&gt;Flask&lt;/a&gt; 是一个轻量级的 WSGI Web 应用程序框架。它旨在使快速入门 Web 开发变得容易，并具有扩展到复杂应用程序的能力。它最初是围绕 Werkzeug 和 Jinja 的简单包装，现在已成为最受欢迎的 Python Web 应用程序框架之一。&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lijianxun.top/3.html&t=认识 Flask"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2022
    简讯
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/me.html">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/alpha87">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157875662-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-157875662-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
